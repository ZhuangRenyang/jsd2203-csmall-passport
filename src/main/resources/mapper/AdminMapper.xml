<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.tedu.jsd2203.csmall.passport.mapper.AdminMapper">
    <!--    int insert(Admin admin);-->
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO ams_admin(id,
                              username,
                              password,
                              nickname,
                              avatar,
                              phone,
                              email,
                              description,
                              enable,
                              last_login_ip,
                              login_count,
                              gmt_last_login,
                              gmt_create,
                              gmt_modified)
        VALUES (#{id},
                #{username},
                #{password},
                #{nickname},
                #{avatar},
                #{phone},
                #{email},
                #{description},
                #{enable},
                #{lastLoginIp},
                #{loginCount},
                #{gmtLastLogin},
                #{gmtCreate},
                #{gmtModified})
    </insert>
    <!--    int countByUsername(String username);-->
    <select id="countByUsername" resultType="int">
        SELECT COUNT(*)
        FROM ams_admin
        WHERE id = #{id}
    </select>

    <!--    List<AdminListItemVO> list();-->
    <select id="list" resultMap="ListItemResultMap">
        SELECT
        <include refid="ListItemQueryFields"/>
        FROM ams_admin
        ORDER BY id
    </select>

    <resultMap id="ListItemResultMap" type="cn.tedu.jsd2203.csmall.passport.pojo.vo.AdminListItemVO">
        <id column="id" property="id"></id>
        <result column="last_login_ip" property="lastLoginIp"></result>
        <result column="login_count" property="loginCount"></result>
    </resultMap>

    <sql id="ListItemQueryFields">
        <if test="true">
            id, username, password, nickname, avatar,
            phone, email, description, enable, last_login_ip,
            login_count
        </if>
    </sql>
</mapper>